create database WS3_BANHANG

use WS3_BANHANG

CREATE TABLE KHACHHANG(
	MAKH nvarchar(5) PRIMARY KEY,
	TENKH nvarchar(30) NOT NULL,
	DIACHI nvarchar(50),DT nvarchar(10) 
	CHECK(LEN(DT) >= 7 AND LEN(DT) <= 10),
	EMAIL nvarchar(30)
)

CREATE TABLE SANPHAM(
	MAVT nvarchar(5) PRIMARY KEY,
	TENVT nvarchar(30) NOT NULL,
	DVT nvarchar(20),
	GIAMUA int CHECK(GIAMUA > 0),
	SLTON int CHECK(SLTON >=0)
	
)

CREATE TABLE HOADON(
	MAHD nvarchar(10) PRIMARY KEY,
	NGAY Date CHECK(NGAY < SYSDATETIME ()),
	MAKH nvarchar(5) foreign key REFERENCES KHACHHANG(MAKH),
	TONGGT int
)

CREATE TABLE CHITIETHOADON(
	MAHD nvarchar(10) foreign key REFERENCES HOADON(MAHD),
	MAVT nvarchar(5) foreign key REFERENCES SANPHAM(MAVT),
	SL int CHECK(SL > 0),
	KHYENMAI int,
	GIABAN int,
	PRIMARY KEY (MAHD, MAVT)
)

INSERT INTO SANPHAM(MAVT, TENVT, DVT, GIAMUA, SLTON)
VALUES
	('VT01','XI MANG','BAO', 50000, 5000),
	('VT02','CAT','KHOI', 45000, 50000),
	('VT03','GACH ONG','VIEN', 120, 80000),
	('VT04','GACH THE','VIEN', 110, 80000),
	('VT05','DA LON','KHOI', 25000, 100000),
	('VT06','DA NHO','KHOI', 33000, 100000)

INSERT INTO KHACHHANG(MAKH, TENKH, DIACHI, DT, EMAIL)
VALUES
	('KH01','NGUYEN THI BE','TAN BINH','8457895','bnt@yahoo.com'),
	('KH02','LE HOANG NAM','BINH CHANH','8457895','namlehoang@abc.com.vn')
INSERT INTO KHACHHANG(MAKH, TENKH, DIACHI)
VALUES
	('KH03','MAI THI QUE ANH','BINH CHANH')
INSERT INTO KHACHHANG(MAKH, TENKH, DIACHI, DT)
VALUES
	('KH04','TRAN THI CHIEU','TAN BINH','8457895')
INSERT INTO KHACHHANG(MAKH, TENKH, DIACHI, EMAIL)
VALUES
	('KH05','LE VAN SANG','QUAN 10','sanglv@hcm.vnn.vn')
INSERT INTO KHACHHANG(MAKH, TENKH, DIACHI, DT)
VALUES
	('KH06','TRAN HOANG KHAI','TAN BINH','8457895')

INSERT INTO HOADON(MAHD, NGAY, MAKH)
VALUES
	('HD001','2000-05-12','KH01'),
	('HD002','2000-05-25','KH02'),
	('HD003','2000-05-25','KH01'),
	('HD004','2000-05-25','KH04'),
	('HD005','2000-05-26','KH04'),
	('HD006','2000-06-02','KH03'),
	('HD007','2000-06-22','KH04'),
	('HD008','2000-06-25','KH03'),
	('HD009','2000-08-15','KH04'),
	('HD010','2000-09-30','KH01')

INSERT INTO CHITIETHOADON(MAHD, MAVT, SL, GIABAN)
VALUES
	('HD001','VT01',5,52000),
	('HD001','VT05',10,30000),
	('HD002','VT03',10000,150),
	('HD003','VT02',20,55000),
	('HD004','VT03',50000,150),
	('HD004','VT04',20000,120),
	('HD005','VT05',10,30000),
	('HD006','VT04',10000,120),
	('HD007','VT04',20000,125),
	('HD008','VT01',100,55000),
	('HD009','VT02',25,48000),
	('HD010','VT01',25,57000)


SELECT * FROM KHACHHANG
SELECT * FROM SANPHAM
SELECT * FROM HOADON
SELECT * FROM CHITIETHOADON
